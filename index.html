<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="viewport" coZZntent="width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    <title>My Synthesizer</title>
    <style>
        @import url(root.css);
    </style>
</head>

<body>

    <synth-app></synth-app>

    <template id="sequencer-step-template">
        <style>
            @import url(seq-step.css);
        </style>
        <input type="range" class="pitch-slider" min="36" max="84" value="60" step="1">
        <div class="step-button">
            <div class="has-data"></div>
        </div>
    </template>

    <template id="synth-app-template">
        <style>
            @import url(synth-app.css);
        </style>

        <h1>My Synthesizer</h1>

        <div class="control-group">
            <div class="control-grid"
                style="grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); align-items: center;">
                <div class="control">
                    <span>Tempo: <span id="tempoValue">120</span> BPM</span>
                    <input type="range" id="tempo" min="30" max="240" value="120">
                    <button id="startStopBtn">Start</button>
                </div>
                <div class="control">
                    <label>Save/Load/Export</label>
                    <div style="display: flex; gap: 5px;">
                        <button id="saveSong">Save Song</button>
                        <button id="loadSong">Load Song</button>
                        <button id="exportWav">Export WAV</button>
                    </div>
                    <input type="file" id="loadSongInput" accept=".json" style="display:none;">
                </div>
                <div class="control">
                    <label>Tuning</label>
                    <button id="loadScl">Load .scl</button>
                    <input type="file" id="tuningFile" accept=".scl" style="display:none;">
                    <span id="tuningName">12-TET</span>
                </div>
            </div>
        </div>

        <div class="control-group">
            <div class="control-grid">

                <div class="control">
                    <h3>MASTER</h3>
                    <div class="control-grid">
                        <div class="control">
                            <label for="master-volume">Volume</label>
                            <input type="range" id="master-volume" min="0" max="1" value="0.7" step="0.01">
                        </div>
                    </div>
                </div>
                <div class="controls">
                    <h3>MIDI</h3>
                    <div class="control-grid">
                        <div class="control">
                            <label for="midi-inputs">Input Device</label>
                            <select id="midi-inputs">
                                <option>No devices found</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="control-group">
            <h3>SYNTHESIZER</h3>
            <div class="control-grid">
                <div class="control"><label>Waveform</label><select id="osc-waveform">
                        <option value="sawtooth">Sawtooth</option>
                        <option value="square">Square</option>
                        <option value="triangle">Triangle</option>
                        <option value="sine">Sine</option>
                    </select></div>
                <div class="control"><label>Portamento</label><input type="range" id="portamento-time" min="0" max="1"
                        value="0" step="0.01"></div>
                <div class="control"><label>Filter Cutoff</label><input type="range" id="filter-cutoff" min="20"
                        max="8000" value="1000" step="1"></div>
                <div class="control"><label>Filter Resonance</label><input type="range" id="filter-resonance" min="0.1"
                        max="18" value="1" step="0.1"></div>
                <div class="control"><label>Pitch LFO Rate</label><input type="range" id="pitch-lfo-rate" min="0.1"
                        max="20" value="5" step="0.1"></div>
                <div class="control"><label>Pitch LFO Depth</label><input type="range" id="pitch-lfo-depth" min="0"
                        max="25" value="0" step="1"></div>
                <div class="control"><label>Cutoff LFO Rate</label><input type="range" id="cutoff-lfo-rate" min="0.1"
                        max="20" value="2" step="0.1"></div>
                <div class="control"><label>Cutoff LFO Depth</label><input type="range" id="cutoff-lfo-depth" min="0"
                        max="4000" value="0" step="10"></div>
            </div>
            <h4>ADSR Envelope</h4>
            <div class="control-grid">
                <div class="control"><label>Attack</label><input type="range" id="env-attack" min="0.01" max="2"
                        value="0.02" step="0.01"></div>
                <div class="control"><label>Decay</label><input type="range" id="env-decay" min="0.01" max="2"
                        value="0.2" step="0.01"></div>
                <div class="control"><label>Sustain</label><input type="range" id="env-sustain" min="0" max="1"
                        value="0.8" step="0.01"></div>
                <div class="control"><label>Release</label><input type="range" id="env-release" min="0.01" max="3"
                        value="0.3" step="0.01"></div>
            </div>
        </div>

        <div class="control-group">
            <h3>EFFECTS</h3>
            <div class="control-grid">
                <div class="control"><label>Reverb</label><input type="range" id="reverb-mix" min="0" max="1"
                        value="0.2" step="0.01"></div>
                <div class="control"><label>Echo Time</label><input type="range" id="delay-time" min="0" max="1"
                        value="0.25" step="0.01"></div>
                <div class="control"><label>Echo Feedback</label><input type="range" id="delay-feedback" min="0"
                        max="0.9" value="0.4" step="0.01"></div>
            </div>
            <div class="control-grid" style="margin-top: 15px;">
                <div class="control"><label>EQ Low</label><input type="range" class="eq-gain" data-freq="250" min="-24"
                        max="24" value="0" step="1"></div>
                <div class="control"><label>EQ Mid</label><input type="range" class="eq-gain" data-freq="1000" min="-24"
                        max="24" value="0" step="1"></div>
                <div class="control"><label>EQ High</label><input type="range" class="eq-gain" data-freq="4000"
                        min="-24" max="24" value="0" step="1"></div>
            </div>
        </div>

        <div class="control-group">
            <h3>SEQUENCER</h3>
            <step-sequencer></step-sequencer>
        </div>
    </template>

    <script src="synth.js" defer></script>
    <script>
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
    </script>
</body>

</html>